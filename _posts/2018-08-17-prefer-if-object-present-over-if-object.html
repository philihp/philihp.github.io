---
layout: post
title: Prefer `if object.present?` over `if object`
date: 2018-08-17 00:53:12.000000000 -07:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags:
- decorator
- draper
- present
- Programming
- rails
- ruby
meta:
  _edit_last: '1'
  _jetpack_related_posts_cache: a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1543441053;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:695;}i:1;a:1:{s:2:"id";i:1320;}i:2;a:1:{s:2:"id";i:1177;}}}}
  _wpas_done_all: '1'
  sharing_disabled: '1'
author:
  login: Philihp
  email: philihp@gmail.com
  display_name: Philihp
  first_name: ''
  last_name: ''
---
<p>So you've got a controller method</p>
<pre lang="ruby">
class DressesController &lt; ApplicationController
  def show
    @dress = Dress.find_by(params.permit(:id))
  end
end
</pre>
<p>And a view</p>
<pre lang="erb">
&lt;div class="&lt;%= dress ? 'dress&.status' : '' %&gt;">Status Indicator&lt;/div&gt;
</pre>
<p>Looks good! Works great! Now your app grows, and you have a lot of other views that use the dress. Long after your view has been forgotten, and there's no clear owner because <a href="https://www.agilealliance.org/glossary/collective-ownership/">everyone owns it</a>, but that's cool because it's regarded as stable, someone comes along and builds another view</p>
<pre lang="erb">
&lt;h1&gt;&lt;%= dress.named? ? dress.name.gsub(' ','_').titleize : 'Unnamed' %&gt;&lt;/h1&gt;
</pre>
<p>Ew gross, so much logic in the view? Gross! Let's put that logic in a <a href="https://github.com/drapergem/draper">decorator</a>!</p>
<pre lang="ruby">
class DressDecorator < Draper::Decorator
  delegate_all
  def title
    dress.named? ? dress.name.gsub(' ','_').titleize : 'Unnamed'
  end
end
</pre>
<p><code>delegate_all</code> will forward all methods it's sent to whatever it's decorating.</p>
<pre lang="ruby">
class DressesController &lt; ApplicationController
  def show
    @dress = DressDecorator.new(Dress.find_by(params.permit(:id)))
  end
end
</pre>
<p>And let's clean up our view.</p>
<pre lang="erb">
&lt;h1&gt;&lt;%= dress.title %&gt;&lt;/h1&gt;
</pre>
<p>But now @dress will always be there, even if it decorates nil, so our old code is broken, and will return</p>
<pre>
NoMethodError (undefined method `status' for #&lt;DressDecorator:0x00007fbc2696d568&gt;)
</pre>
<p>Because of this, it's always important to <a href="https://medium.freecodecamp.org/how-to-make-your-code-better-with-intention-revealing-function-names-6c8b5271693e">code your intention</a>, rather than code to save keystrokes. Use <code>dress.present?</code>, because that's what you're checking, even though it's the same as <code>dress</code> <i>right now</i>.</p>
<pre lang="erb">
&lt;div class="&lt;%= dress.present? ? 'dress&.status' : '' %&gt;">Status Indicator&lt;/div&gt;
</pre>
<p>In other words, watch out for this...</p>
<pre lang="ruby">
d = Dress.new(foo: 'bar')
!d.nil?
=> true
d.present?
=> true
d&.foo
=> 'bar'

dd = DressDecorator.new(d)
!dd.nil?
=> true
dd.present?
=> false
dd&.foo
<b>Traceback</b> (most recent call last):
<b>NameError (undefined local variable or method `foo' for main:Object)</b>

</pre>
