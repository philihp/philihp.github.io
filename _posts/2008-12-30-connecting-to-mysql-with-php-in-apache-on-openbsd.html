---
layout: post
title: Connecting to MySQL with PHP in Apache on OpenBSD
date: 2008-12-30 19:36:00.000000000 -08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags:
- MySQL
- OpenBSD
- PHP
- Programming
meta:
  blogger_blog: philihp.blogspot.com
  blogger_author: Philihp Busbyhttp://www.blogger.com/profile/16640093851362468089noreply@blogger.com
  blogger_permalink: "/2008/12/connecting-to-mysql-with-php-in-apache.html"
  _edit_last: '1'
  tmac_last_id: '166390265060401152'
  _jetpack_related_posts_cache: a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1543627605;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:1354;}i:1;a:1:{s:2:"id";i:378;}i:2;a:1:{s:2:"id";i:704;}}}}
author:
  login: Philihp
  email: philihp@gmail.com
  display_name: Philihp
  first_name: ''
  last_name: ''
---
<p>If you try to connect to MySQL with any scripting language running under Apache on OpenBSD, you're liable to get the error:</p>
<p><code>Can't connect to local MySQL server through socket '/var/run/mysql/mysql.sock' (2)</code></p>
<p>This can be infuriating, since every setting is probably going to either still be the default setting, or be a correct setting; and the error will persist. The reason for this is simple.</p>
<p>OpenBSD <code>chroot</code>s Apache into <code>/var/www/</code>. This means, as far as Apache is concerned, its entire world exists within /var/www, and it can never, ever, break out. In the likely event that a hacker compromises the Apache process into executing code (which is a probable event), any damage will be contained.</p>
<p>So when PHP tries to open /var/run/mysql/mysql.sock, it's <i>actually</i> looking for /var/www/var/run/mysql/mysql.sock, and failing.</p>
<p>The solution to this is given <a href="http://www.openbsdsupport.org/e107_CMS.html">here</a>. It is to update your /etc/rc.local startup script to create a link to the file into the /var/www/ jail during startup.</p>
