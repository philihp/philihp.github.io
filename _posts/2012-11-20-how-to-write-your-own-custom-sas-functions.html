---
layout: post
title: How to write your own Custom SAS Functions
date: 2012-11-20 17:30:13.000000000 -08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags:
- Custom
- functions
- How To
- Metadata
- proc fcmp
- Programming
- SAS
- user-written
meta:
  _edit_last: '1'
  _jetpack_related_posts_cache: a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1543456820;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:1144;}i:1;a:1:{s:2:"id";i:1069;}i:2;a:1:{s:2:"id";i:992;}}}}
author:
  login: Philihp
  email: philihp@gmail.com
  display_name: Philihp
  first_name: ''
  last_name: ''
---
<p>Since SAS 9.1.3 we've had the ability to write our own SAS call procedures and functions using PROC FCMP (short for "Function Compiler"). A simple example of this is as follows:</p>
<pre lang="sas">proc fcmp outlib=work.funcs.temp;
  function findname(uri $) $200;
    length name $200;
    rc = metadata_getattr(uri,'Name',name);
	return(name);
  endsub;
run;</pre>
<p>After running this, we should have a custom function available for use in any data step. The function listed here will contact the SAS Metadata Server using <a href="http://support.sas.com/documentation/cdl/en/lrmeta/60739/HTML/default/viewer.htm#getattr.htm">metadata_getattr</a> and return the "Name" attribute of an object at the given URI. You'll have to add that location to the cmplib search path (similar to adding a location to a format search path), which can be achieved by doing</p>
<pre lang="sas">options cmplib=work.funcs;</pre>
<p>If you do so, the following data step</p>
<pre lang="sas">options cmplib=work.funcs;
data _null_;
  uri = 'omsobj:PhysicalTable/A5M6KWHB.BI00001E';
  name = findname(uri);
  put name=;
run;</pre>
<p>will output</p>
<pre lang="text">name=MYTABLE</pre>
<p>because I have a table registered in my metadata called "MYTABLE" at that location.</p>
<p>The possibilities with PROC FCMP are seemingly endless. For example, user-written functions allow you to write recursive calls. Before FCMP, you either had to write recursive SCL <a href="http://support.sas.com/documentation/cdl/en/sclref/59578/HTML/default/viewer.htm#a000164465.htm">which had an arbitrary stack limit of 10</a>, or recursive Macro calls which makes <a href="http://support.sas.com/documentation/cdl/en/mcrolref/61885/HTML/default/viewer.htm#z3514sysfunc.htm">calling system functions cumbersome</a>. Learn more about it <a href="http://support.sas.com/documentation/cdl/en/proc/65145/HTML/default/viewer.htm#p10b4qouzgi6sqn154ipglazix2q.htm">here</a>.</p>
